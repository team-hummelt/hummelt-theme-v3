(()=>{"use strict";const e=window.React,t=window.ReactJSXRuntime,{registerBlockType:l}=wp.blocks,{InspectorControls:i,MediaPlaceholder:a,MediaUpload:n,BlockControls:s}=wp.blockEditor,{PanelBody:o,ToggleControl:d,SelectControl:r,RadioControl:m,RangeControl:c,TextControl:u,Button:h,Modal:b,ToolbarButton:g,ToolbarGroup:x}=wp.components,{__}=wp.i18n,{useEffect:p,useState:j}=wp.element;l("hupa/gallery-slideshow-block",{title:"Galerie Slider",icon:"images-alt2",category:"theme-v3-medien",description:"Slider von splideJs mit vielen Optionen.",attributes:{images:{type:"array",default:[]},mediumImages:{type:"array",default:[]},selectedSlider:{type:"string",default:""},sliderId:{type:"string",default:""},sliderHeight:{type:"number",default:200},thumbHeight:{type:"number",default:150},thumbFocus:{type:"text",default:"center"},objectPosition:{type:"string",default:"center"},objectFit:{type:"string",default:"cover"},imageSize:{type:"string",default:"large"},thumbSize:{type:"string",default:"medium"},showFocus:{type:"boolean",default:!1},enableLightbox:{type:"boolean",default:!1},ausgabeOption:{type:"string",default:""},enableTitle:{type:"boolean",default:!0},openNewTab:{type:"boolean",default:!1},clickAction:{type:"string",default:""},imgLink:{type:"string",default:""},lightboxSingle:{type:"boolean",default:!1},layout:{type:"string",default:"slideshow"}},edit({attributes:l,setAttributes:v}){const{images:y,lightboxSingle:_,clickAction:k,mediumImages:N,ausgabeOption:f,enableTitle:S,thumbSize:w,imageSize:C,layout:H,sliderHeight:F,objectPosition:B,objectFit:M,thumbHeight:T,thumbFocus:z,sliderId:I,showFocus:P}=l;if(!I){const e=`${Math.random().toString(36).slice(2,9)}`;v({sliderId:e})}const[O,A]=j([]),[L,R]=j(l.selectedSlider),[$,G]=j(""),[E,q]=j(),[J,Q]=j(),[U,W]=j(!1);return p((()=>{y.length>0&&document.querySelectorAll(".sortable-list").forEach((e=>{jQuery(e).sortable({update:(t,l)=>{const i=jQuery(e).sortable("toArray",{attribute:"data-id"}).map((e=>parseInt(e,10))).map((e=>y.find((t=>t.id===e))));v({images:i})}})}))}),[y]),p((()=>{wp.apiFetch({path:hummeltRestEditorObj.gutenberg_rest_path+"settings",method:"POST",data:{method:"get_theme_slider"}}).then((e=>{e.status&&A(e.slider)})).catch((e=>{console.error("Fehler beim Laden der Optionen:",e)}))}),[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s,{children:(0,t.jsx)(x,{children:(0,t.jsx)(n,{onSelect:e=>{const t=e.map((e=>({id:e.id,link:"",tab:!1,url:e?.sizes?.[C]?.url||e.url,alt:e.alt||"",title:e.caption||""})));v({images:t})},allowedTypes:["image"],multiple:!0,gallery:!0,value:y.map((e=>e.id)),render:({open:e})=>(0,t.jsx)(g,{icon:"images-alt2",text:"Galerie bearbeiten",label:"Galerie bearbeiten",onClick:e})})})}),(0,t.jsxs)("div",{className:"slideshow-editor",children:[(0,t.jsx)(i,{children:(0,t.jsxs)(o,{title:__("Slider Settings","text-domain"),children:[(0,t.jsx)(r,{label:"Slider auswählen",__nextHasNoMarginBottom:!0,value:L,options:O,onChange:e=>{R(e),v({selectedSlider:e})}}),(0,t.jsx)(r,{label:__("Image Size","text-domain"),__nextHasNoMarginBottom:!0,value:C,options:[{label:__("Thumbnail","text-domain"),value:"thumbnail"},{label:__("Medium","text-domain"),value:"medium"},{label:__("Large","text-domain"),value:"large"},{label:__("Full","text-domain"),value:"full"}],onChange:e=>v({imageSize:e})}),(0,t.jsx)(r,{label:__("Object Fit","text-domain"),__nextHasNoMarginBottom:!0,value:M,options:[{label:__("cover","text-domain"),value:"cover"},{label:__("contain","text-domain"),value:"contain"},{label:__("none","text-domain"),value:"none"},{label:__("inherit","text-domain"),value:"inherit"}],onChange:e=>v({objectFit:e})}),(0,t.jsx)(u,{label:"Object-Position",value:B,__nextHasNoMarginBottom:!0,type:"text",onChange:e=>v({objectPosition:e})}),(0,t.jsx)("hr",{}),(0,t.jsx)(d,{label:__("Focus aktiv","text-domain"),__nextHasNoMarginBottom:!0,checked:P,onChange:()=>v({showFocus:!P})}),(0,t.jsx)(u,{label:"Focus",disabled:!P,value:z,__nextHasNoMarginBottom:!0,type:"text",onChange:e=>v({thumbFocus:e}),help:"mögliche Werte: 0-9 | center | false"}),(0,t.jsx)("hr",{}),(0,t.jsx)(m,{label:__("Ausgabe Option","text-domain"),selected:f,__nextHasNoMarginBottom:!0,options:[{label:__("keine Aktion","text-domain"),value:""},{label:__("Caption anzeigen","text-domain"),value:"caption"}],onChange:e=>v({ausgabeOption:e})}),(0,t.jsx)(d,{label:"Titel anzeigen",__nextHasNoMarginBottom:!0,checked:S,onChange:e=>v({enableTitle:e})}),(0,t.jsx)("hr",{}),(0,t.jsx)(c,{label:"Feste Höhe (px)",value:F,__nextHasNoMarginBottom:!0,onChange:e=>v({sliderHeight:e}),min:0,max:1e3}),(0,t.jsx)(m,{label:__("Aktion beim klicken","text-domain"),selected:k,__nextHasNoMarginBottom:!0,options:[{label:__("keine Aktion","text-domain"),value:""},{label:__("Lightbox","text-domain"),value:"lightbox"},{label:__("Individuell","text-domain"),value:"individuell"}],onChange:e=>v({clickAction:e})}),(0,t.jsx)("div",{className:"lightbox"===k?"":"d-none",children:(0,t.jsx)(d,{label:__("Lightbox single","text-domain"),__nextHasNoMarginBottom:!0,checked:_,onChange:()=>v({lightboxSingle:!_})})}),(0,t.jsx)("div",{style:{margin:".5rem 0"}}),(0,t.jsx)(m,{label:__("Layout","text-domain"),selected:H,__nextHasNoMarginBottom:!0,options:[{label:__("Slideshow","text-domain"),value:"slideshow"},{label:__("Gallery with Thumbnails","text-domain"),value:"gallery"}],onChange:e=>v({layout:e})}),(0,t.jsxs)("div",{className:"slideshow"===H?"d-none":"",children:[(0,t.jsx)(r,{label:__("Thumbnail Size","text-domain"),__nextHasNoMarginBottom:!0,value:w,options:[{label:__("Thumbnail","text-domain"),value:"thumbnail"},{label:__("Medium","text-domain"),value:"medium"},{label:__("Large","text-domain"),value:"medium_large"},{label:__("Full","text-domain"),value:"full"}],onChange:e=>v({thumbSize:e})}),(0,t.jsx)(c,{label:"Thumbnail Höhe (Px)",value:T,__nextHasNoMarginBottom:!0,onChange:e=>v({thumbHeight:e}),min:0,max:1e3})]})]})}),y.length>0?(0,t.jsx)(e.Fragment,{children:(0,t.jsx)("ul",{className:"sortable-list list-unstyled row g-3",children:y.map(((e,l)=>(0,t.jsxs)("li",{className:"sortable-item col-auto","data-id":e.id,children:[(0,t.jsx)("img",{src:e.url,alt:e.alt,className:"img-fluid rounded border",style:{height:"150px",objectFit:"cover"}}),(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{className:"btn btn-link text-decoration-none text-danger btn-sm mt-1",onClick:()=>(e=>{const t=y.filter(((t,l)=>l!==e)),l=N.filter(((t,l)=>l!==e));v({images:t}),v({mediumImages:l})})(l),children:"löschen"}),"individuell"===k?(0,t.jsx)("button",{className:"btn btn-link text-primary text-decoration-none btn-sm mt-1",onClick:()=>(e=>{const t=y.find((({id:t})=>t===e));G(t.link),q(t.tab),Q(t.id),W(!0)})(e.id),children:"Optionen"}):""]})]},e.id)))})}):(0,t.jsx)(a,{onSelect:e=>{v({images:e.map((e=>({id:e.id,link:"",tab:!1,url:e?.sizes?.[C]?.url||e?.url||"",alt:e.alt,title:e.caption||""})))}),v({mediumImages:e.map((e=>({id:e.id,url:e?.sizes?.[w]?.url||e?.url||"",alt:e.alt,title:e.caption||""})))})},allowedTypes:["image"],multiple:!0}),U&&(0,t.jsxs)(b,{title:"Bildoptionen",onRequestClose:()=>W(!1),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u,{label:"Link-Url",value:$,__nextHasNoMarginBottom:!0,type:"text",onChange:e=>G(e)}),(0,t.jsx)("div",{style:{margin:".5rem 0"}}),(0,t.jsx)(d,{disabled:!$,label:__("in neuem Tab öffnen","text-domain"),__nextHasNoMarginBottom:!0,checked:E||!1,onChange:e=>q(e)})]}),(0,t.jsx)(h,{isPrimary:!0,onClick:()=>{const e=y.map((e=>e.id===J?{...e,link:$,tab:E}:e));v({images:e}),W(!1)},style:{marginTop:"18px"},children:"Speichern"})]})]})]})},save({attributes:e}){const{images:l,mediumImages:i,clickAction:a,lightboxSingle:n,imageSize:s,ausgabeOption:o,enableTitle:d,layout:r,objectPosition:m,selectedSlider:c,sliderHeight:u,objectFit:h,thumbHeight:b,sliderId:g,thumbFocus:x,showFocus:p}=e;return c&&l.length?"gallery"===r?(0,t.jsxs)("div",{"data-focus-active":p,"data-lightbox-single":n,"data-focus":x,"data-slider":c,className:"thumbnail-slider",children:[(0,t.jsx)("section",{id:`main-carousel-${g}`,className:"splide carousel-splide "+("lightbox"===a?"with-lightbox":""),"aria-label":"Gallery",children:(0,t.jsx)("div",{className:"splide__track",children:(0,t.jsx)("div",{style:{height:u?u+"px":"100%"},className:"splide__list",children:l.map((e=>(0,t.jsx)("a",{target:e.tab?"_blank":"_self",href:"lightbox"===a?e.url:""!==e.link?e.link:"",className:"splide__slide "+("lightbox"===a||"individuell"===a&&""!==e.link?"cursor-pointer":"pe-none"),children:(0,t.jsx)("img",{style:{objectPosition:m,objectFit:h,height:u?u+"px":"100%"},"data-splide-lazy":e.url,alt:e.alt,className:`size-${s}`})},e.id)))})})}),(0,t.jsx)("section",{id:`main-carousel-thumbnails-${g}`,className:"thumbnails mt-2 splide","aria-label":"Thumbnails",children:(0,t.jsx)("div",{className:"splide__track",children:(0,t.jsx)("ul",{id:`thumbnails-${g}`,className:"splide__list",children:i.map((e=>(0,t.jsx)("li",{style:{height:"100%",maxHeight:b+"px"},className:"thumbnail thumbnail-splide splide__slide",children:(0,t.jsx)("img",{style:{objectPosition:m,objectFit:h,height:b+"px"},"data-splide-lazy":e.url,alt:e.alt})},e.id)))})})})]}):(0,t.jsx)("div",{"data-focus-active":p,"data-lightbox-single":n,"data-focus":x,"data-slider":c,className:"theme-slider",children:(0,t.jsx)("div",{id:`slider-${g}`,className:"slideshow splide "+("lightbox"===a?"with-lightbox":""),children:(0,t.jsx)("div",{className:"splide__track",children:(0,t.jsx)("div",{className:"splide__list "+(l.length<3?"justify-content-center":""),children:l.map((e=>(0,t.jsx)("a",{target:e.tab?"_blank":"_self",href:"lightbox"===a?e.url:""!==e.link?e.link:"",title:d?e.title:"",style:{height:"100%",maxHeight:u?u+"px":"100%"},className:"splide__slide "+("lightbox"===a||"individuell"===a&&""!==e.link?"cursor-pointer":"pe-none"),children:(0,t.jsxs)("div",{className:"slide-wrapper",children:[(0,t.jsx)("div",{className:"slide-inner",children:(0,t.jsx)("img",{style:{height:u?u+"px":"100%",width:"100%",maxHeight:"100%",objectPosition:m,objectFit:h},"data-splide-lazy":e.url,alt:e.alt,className:`size-${s}`})}),"caption"===o?(0,t.jsxs)("div",{className:"gallery-slider-item-caption pe-none text-reset text-decoration-none",children:[" ",e.title]}):""]})},e.id)))})})})}):(0,t.jsx)(t.Fragment,{})}})})();