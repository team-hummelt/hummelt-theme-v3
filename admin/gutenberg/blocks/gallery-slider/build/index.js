(()=>{"use strict";const e=window.React,t=window.ReactJSXRuntime,{registerBlockType:i}=wp.blocks,{InspectorControls:l,MediaPlaceholder:a,MediaUpload:s}=wp.blockEditor,{PanelBody:n,ToggleControl:o,SelectControl:d,RadioControl:r,RangeControl:m,TextControl:c,Button:u,Modal:h}=wp.components,{__}=wp.i18n,{useEffect:g,useState:b}=wp.element;i("hupa/gallery-slideshow-block",{title:"Galerie Slider",icon:"images-alt2",category:"theme-v3-medien",description:"Slider von splideJs mit vielen Optionen.",attributes:{images:{type:"array",default:[]},mediumImages:{type:"array",default:[]},selectedSlider:{type:"string",default:""},sliderId:{type:"string",default:""},sliderHeight:{type:"number",default:200},thumbHeight:{type:"number",default:150},thumbFocus:{type:"text",default:"center"},objectPosition:{type:"string",default:"center"},objectFit:{type:"string",default:"cover"},imageSize:{type:"string",default:"large"},thumbSize:{type:"string",default:"medium"},showFocus:{type:"boolean",default:!1},enableLightbox:{type:"boolean",default:!1},openNewTab:{type:"boolean",default:!1},clickAction:{type:"string",default:""},imgLink:{type:"string",default:""},lightboxSingle:{type:"boolean",default:!1},layout:{type:"string",default:"slideshow"}},edit({attributes:i,setAttributes:x}){const{images:p,lightboxSingle:j,clickAction:v,mediumImages:y,thumbSize:_,imageSize:N,layout:f,sliderHeight:k,objectPosition:S,objectFit:w,thumbHeight:H,thumbFocus:F,sliderId:C,showFocus:M}=i;if(!C){const e=`${Math.random().toString(36).slice(2,9)}`;x({sliderId:e})}const[B,z]=b([]),[T,I]=b(i.selectedSlider),[P,A]=b(""),[L,O]=b(),[R,$]=b(),[E,G]=b(!1);return g((()=>{p.length>0&&document.querySelectorAll(".sortable-list").forEach((e=>{jQuery(e).sortable({update:(t,i)=>{const l=jQuery(e).sortable("toArray",{attribute:"data-id"}).map((e=>parseInt(e,10))).map((e=>p.find((t=>t.id===e))));x({images:l})}})}))}),[p]),g((()=>{wp.apiFetch({path:hummeltRestEditorObj.gutenberg_rest_path+"settings",method:"POST",data:{method:"get_theme_slider"}}).then((e=>{e.status&&z(e.slider)})).catch((e=>{console.error("Fehler beim Laden der Optionen:",e)}))}),[]),(0,t.jsxs)("div",{className:"slideshow-editor",children:[(0,t.jsx)(l,{children:(0,t.jsxs)(n,{title:__("Slider Settings","text-domain"),children:[(0,t.jsx)(d,{label:"Slider auswählen",__nextHasNoMarginBottom:!0,value:T,options:B,onChange:e=>{I(e),x({selectedSlider:e})}}),(0,t.jsx)(d,{label:__("Image Size","text-domain"),__nextHasNoMarginBottom:!0,value:N,options:[{label:__("Thumbnail","text-domain"),value:"thumbnail"},{label:__("Medium","text-domain"),value:"medium"},{label:__("Large","text-domain"),value:"large"},{label:__("Full","text-domain"),value:"full"}],onChange:e=>x({imageSize:e})}),(0,t.jsx)(d,{label:__("Object Fit","text-domain"),__nextHasNoMarginBottom:!0,value:w,options:[{label:__("cover","text-domain"),value:"cover"},{label:__("contain","text-domain"),value:"contain"},{label:__("none","text-domain"),value:"none"},{label:__("inherit","text-domain"),value:"inherit"}],onChange:e=>x({objectFit:e})}),(0,t.jsx)(c,{label:"Object-Position",value:S,__nextHasNoMarginBottom:!0,type:"text",onChange:e=>x({objectPosition:e})}),(0,t.jsx)("hr",{}),(0,t.jsx)(o,{label:__("Focus aktiv","text-domain"),__nextHasNoMarginBottom:!0,checked:M,onChange:()=>x({showFocus:!M})}),(0,t.jsx)(c,{label:"Focus",disabled:!M,value:F,__nextHasNoMarginBottom:!0,type:"text",onChange:e=>x({thumbFocus:e}),help:"mögliche Werte: 0-9 | center | false"}),(0,t.jsx)(m,{label:"Feste Höhe (px)",value:k,__nextHasNoMarginBottom:!0,onChange:e=>x({sliderHeight:e}),min:0,max:1e3}),(0,t.jsx)(r,{label:__("Aktion beim klicken","text-domain"),selected:v,__nextHasNoMarginBottom:!0,options:[{label:__("keine Aktion","text-domain"),value:""},{label:__("Lightbox","text-domain"),value:"lightbox"},{label:__("Individuell","text-domain"),value:"individuell"}],onChange:e=>x({clickAction:e})}),(0,t.jsx)("div",{className:"lightbox"===v?"":"d-none",children:(0,t.jsx)(o,{label:__("Lightbox single","text-domain"),__nextHasNoMarginBottom:!0,checked:j,onChange:()=>x({lightboxSingle:!j})})}),(0,t.jsx)("div",{style:{margin:".5rem 0"}}),(0,t.jsx)(r,{label:__("Layout","text-domain"),selected:f,__nextHasNoMarginBottom:!0,options:[{label:__("Slideshow","text-domain"),value:"slideshow"},{label:__("Gallery with Thumbnails","text-domain"),value:"gallery"}],onChange:e=>x({layout:e})}),(0,t.jsxs)("div",{className:"slideshow"===f?"d-none":"",children:[(0,t.jsx)(d,{label:__("Thumbnail Size","text-domain"),__nextHasNoMarginBottom:!0,value:_,options:[{label:__("Thumbnail","text-domain"),value:"thumbnail"},{label:__("Medium","text-domain"),value:"medium"},{label:__("Large","text-domain"),value:"medium_large"},{label:__("Full","text-domain"),value:"full"}],onChange:e=>x({thumbSize:e})}),(0,t.jsx)(m,{label:"Thumbnail Höhe (Px)",value:H,__nextHasNoMarginBottom:!0,onChange:e=>x({thumbHeight:e}),min:0,max:1e3})]})]})}),p.length>0?(0,t.jsxs)(e.Fragment,{children:[(0,t.jsx)("ul",{className:"sortable-list list-unstyled row g-3",children:p.map(((e,i)=>(0,t.jsxs)("li",{className:"sortable-item col-auto","data-id":e.id,children:[(0,t.jsx)("img",{src:e.url,alt:e.alt,className:"img-fluid rounded border",style:{height:"150px",objectFit:"cover"}}),(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{className:"btn btn-link text-decoration-none text-danger btn-sm mt-1",onClick:()=>(e=>{const t=p.filter(((t,i)=>i!==e)),i=y.filter(((t,i)=>i!==e));x({images:t}),x({mediumImages:i})})(i),children:"löschen"}),"individuell"===v?(0,t.jsx)("button",{className:"btn btn-link text-primary text-decoration-none btn-sm mt-1",onClick:()=>(e=>{const t=p.find((({id:t})=>t===e));A(t.link),O(t.tab),$(t.id),G(!0)})(e.id),children:"Optionen"}):""]})]},e.id)))}),(0,t.jsx)("div",{className:"add-images-button",children:(0,t.jsx)(s,{onSelect:e=>{const t=[...p,...e.map((e=>({id:e.id,url:e.url,alt:e.alt||""})))];x({images:t})},allowedTypes:["image"],multiple:!0,render:({open:e})=>(0,t.jsx)(u,{onClick:e,variant:"primary",className:"add-images-button",children:__("Bild hinzufügen","text-domain")})})})]}):(0,t.jsx)(a,{onSelect:e=>{x({images:e.map((e=>({id:e.id,link:"",tab:!1,url:e?.sizes?.[N]?.url||e?.url||"",alt:e.alt,title:e.caption||""})))}),x({mediumImages:e.map((e=>({id:e.id,url:e?.sizes?.[_]?.url||e?.url||"",alt:e.alt,title:e.caption||""})))})},allowedTypes:["image"],multiple:!0}),E&&(0,t.jsxs)(h,{title:"Bildoptionen",onRequestClose:()=>G(!1),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c,{label:"Link-Url",value:P,__nextHasNoMarginBottom:!0,type:"text",onChange:e=>A(e)}),(0,t.jsx)("div",{style:{margin:".5rem 0"}}),(0,t.jsx)(o,{disabled:!P,label:__("in neuem Tab öffnen","text-domain"),__nextHasNoMarginBottom:!0,checked:L||!1,onChange:e=>O(e)})]}),(0,t.jsx)(u,{isPrimary:!0,onClick:()=>{const e=p.map((e=>e.id===R?{...e,link:P,tab:L}:e));x({images:e}),G(!1)},style:{marginTop:"18px"},children:"Speichern"})]})]})},save({attributes:e}){const{images:i,mediumImages:l,clickAction:a,lightboxSingle:s,imageSize:n,layout:o,objectPosition:d,selectedSlider:r,sliderHeight:m,objectFit:c,thumbHeight:u,sliderId:h,thumbFocus:g,showFocus:b}=e;return r&&i.length?"gallery"===o?(0,t.jsxs)("div",{"data-focus-active":b,"data-lightbox-single":s,"data-focus":g,"data-slider":r,className:"thumbnail-slider",children:[(0,t.jsx)("section",{id:`main-carousel-${h}`,className:"splide carousel-splide "+("lightbox"===a?"with-lightbox":""),"aria-label":"Gallery",children:(0,t.jsx)("div",{className:"splide__track",children:(0,t.jsx)("div",{style:{height:m?m+"px":"100%"},className:"splide__list",children:i.map((e=>(0,t.jsx)("a",{target:e.tab?"_blank":"_self",href:"lightbox"===a?e.url:""!==e.link?e.link:"",className:"splide__slide "+("lightbox"===a||"individuell"===a&&""!==e.link?"cursor-pointer":"pe-none"),children:(0,t.jsx)("img",{style:{objectPosition:d,objectFit:c,height:m?m+"px":"100%"},"data-splide-lazy":e.url,alt:e.alt,className:`size-${n}`})},e.id)))})})}),(0,t.jsx)("section",{id:`main-carousel-thumbnails-${h}`,className:"thumbnails mt-2 splide","aria-label":"Thumbnails",children:(0,t.jsx)("div",{className:"splide__track",children:(0,t.jsx)("ul",{id:`thumbnails-${h}`,className:"splide__list",children:l.map((e=>(0,t.jsx)("li",{style:{height:"100%",maxHeight:u+"px"},className:"thumbnail thumbnail-splide splide__slide",children:(0,t.jsx)("img",{style:{objectPosition:d,objectFit:c,height:u+"px"},"data-splide-lazy":e.url,alt:e.alt})},e.id)))})})})]}):(0,t.jsx)("div",{"data-focus-active":b,"data-lightbox-single":s,"data-focus":g,"data-slider":r,className:"theme-slider",children:(0,t.jsx)("div",{id:`slider-${h}`,className:"slideshow splide "+("lightbox"===a?"with-lightbox":""),children:(0,t.jsx)("div",{className:"splide__track",children:(0,t.jsx)("div",{className:"splide__list "+(i.length<3?"justify-content-center":""),children:i.map((e=>(0,t.jsx)("a",{target:e.tab?"_blank":"_self",href:"lightbox"===a?e.url:""!==e.link?e.link:"",title:e.title,style:{height:"100%",maxHeight:m?m+"px":"100%"},className:"splide__slide "+("lightbox"===a||"individuell"===a&&""!==e.link?"cursor-pointer":"pe-none"),children:(0,t.jsx)("div",{className:"slide-wrapper",children:(0,t.jsx)("div",{className:"slide-inner",children:(0,t.jsx)("img",{style:{height:m?m+"px":"100%",width:"100%",maxHeight:"100%",objectPosition:d,objectFit:c},"data-splide-lazy":e.url,alt:e.alt,className:`size-${n}`})})})},e.id)))})})})}):(0,t.jsx)(t.Fragment,{})}})})();